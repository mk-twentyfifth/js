<html>
  <body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docxtemplater/3.65.2/docxtemplater.js"></script>
    <script src="https://unpkg.com/pizzip@3.2.0/dist/pizzip.js"></script>
    <script src="https://unpkg.com/pizzip@3.2.0/dist/pizzip-utils.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.js"></script>
    <!--
            Mandatory in IE 6, 7, 8 and 9.
        -->
    <!--[if IE]>
      <script
        type="text/javascript"
        src="https://unpkg.com/pizzip@3.2.0/dist/pizzip-utils-ie.js"
      ></script>
    <![endif]-->
    <input type="file" id="doc" />
    <button onclick="generate()">Generate document</button>
    <script>
      const docs = document.getElementById("doc");
      window.generate = function generate() {
        const reader = new FileReader();
        if (docs.files.length === 0) {
          alert("No files selected");
        }
        reader.readAsBinaryString(docs.files.item(0));

        reader.onerror = function (evt) {
          console.log("error reading file", evt);
          alert("error reading file" + evt);
        };
        reader.onload = function (evt) {
          const content = evt.target.result;
          const zip = new PizZip(content);
          const doc = new window.docxtemplater(zip, {
            paragraphLoop: true,
            linebreaks: true,
          });

          // Render the document (Replace {first_name} by John, {last_name} by Doe)
          doc.render({
            first_name: "John",
            last_name: "Doe",
            phone: "+33666666",
            description: "The Acme Product",
          });

          /*
           * Output the document using Data-URI
           * This method `toBlob()` is available since docxtemplater@3.62.0
           */
          saveAs(doc.toBlob(), "output.docx");
        };
      };
    </script>
  </body>
</html>
