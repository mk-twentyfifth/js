<html>
  <body>
    <button onclick="generate()">Generate document</button>
  </body>
  <!-- Run docxtemplater, pizzip, and filesaver scripts !-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/docxtemplater/3.65.2/docxtemplater.js"></script>
  <script src="https://unpkg.com/pizzip@3.2.0/dist/pizzip.js"></script>
  <script src="https://unpkg.com/pizzip@3.2.0/dist/pizzip-utils.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.js"></script>
  <!--
    Mandatory in IE 6, 7, 8 and 9.
    -->
  <!--[if IE]>
    <script
      type="text/javascript"
      src="https://unpkg.com/pizzip@3.2.0/dist/pizzip-utils-ie.js"
    ></script>
  <![endif]-->
  <script>
    function loadFile(url, callback) {
      PizZipUtils.getBinaryContent(url, callback);
    }
    
    window.generate = function generate() {
      loadFile(
        // the "template" example hosted by us
        "https://docxtemplater.com/input.docx",
        function (error, content) {
          if (error) {
            throw error;
          }

          const zip = new PizZip(content);

          const doc = new window.docxtemplater(zip, {
            paragraphLoop: true,
            linebreaks: true,
          });

          // Render the document (Replace {first_name} by John, {last_name} by Doe)
          doc.render({
            first_name: "John",
            last_name: "Doe",
            phone: "+33666666",
            description: "The Acme Product",
          });

          /*
           * Output the document using Data-URI
           * This method `toBlob()` is available since docxtemplater@3.62.0
           */
          saveAs(doc.toBlob(), "output.docx");
        }
      );
    };
  </script>
</html>
